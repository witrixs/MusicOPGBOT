const { EmbedBuilder } = require('discord.js');
const { Translate } = require('../process_tools');

module.exports = async ({ client, inter, queue }) => {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–≥—Ä–∞–µ—Ç –ª–∏ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º—É–∑—ã–∫–∞
    if (!queue?.isPlaying()) 
        return inter.editReply({ content: await Translate(`–°–µ–π—á–∞—Å –º—É–∑—ã–∫–∞ –Ω–µ –∏–≥—Ä–∞–µ—Ç... –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞? <‚ùå>`) });
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ç—Ä–µ–∫–∏ –≤ –æ—á–µ—Ä–µ–¥–∏ –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ
    if (!queue.tracks.toArray()[0]) 
        return inter.editReply({ content: await Translate(`–ù–µ—Ç –º—É–∑—ã–∫–∏ –≤ –æ—á–µ—Ä–µ–¥–∏ –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–π <${inter.member}>... –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞? <‚ùå>`) });

    const methods = ['', 'üîÅ', 'üîÇ']; // –ú–∞—Å—Å–∏–≤ —Å —Ä–µ–∂–∏–º–∞–º–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
    const songs = queue.tracks.length; // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–∫–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏
    const nextSongs = songs > 5 
        ? await Translate(`–ò <**${songs - 5}**> –¥—Ä—É–≥–∏—Ö –ø–µ—Å–µ–Ω...`) // –ï—Å–ª–∏ –±–æ–ª—å—à–µ 5, –≤—ã–≤–æ–¥–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è
        : await Translate(`–í –ø–ª–µ–π–ª–∏—Å—Ç–µ <**${songs}**> –ø–µ—Å–µ–Ω...`); // –ï—Å–ª–∏ 5 –∏–ª–∏ –º–µ–Ω—å—à–µ, –≤—ã–≤–æ–¥–∏–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ

    // –ü–æ–ª—É—á–∞–µ–º –º–∞—Å—Å–∏–≤ —Å —Ç—Ä–µ–∫–∞–º–∏, –¥–æ–±–∞–≤–ª—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º
    const tracks = await Promise.all(queue.tracks.map(async (track, i) => 
        await Translate(`<**${i + 1}**> - <${track.title} | ${track.author}> (–∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∞—Å—å: <${track.requestedBy ? track.requestedBy.displayName : "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}>)`)
    ));

    // –°–æ–∑–¥–∞–µ–º embed-—Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–π –æ—á–µ—Ä–µ–¥–∏
    const embed = new EmbedBuilder()
        .setColor('#ff0000') // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç embed-—Å–æ–æ–±—â–µ–Ω–∏—è
        .setThumbnail(inter.guild.iconURL({ size: 2048, dynamic: true })) // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–∞—Ç—é—Ä—É —Å –∏–∫–æ–Ω–∫–æ–π —Å–µ—Ä–≤–µ—Ä–∞
        .setAuthor({ 
            name: await Translate(`–û—á–µ—Ä–µ–¥—å —Å–µ—Ä–≤–µ—Ä–∞ - <${inter.guild.name} ${methods[queue.repeatMode]}>`), // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ä–µ–∂–∏–º–æ–º –ø–æ–≤—Ç–æ—Ä–∞
            iconURL: client.user.displayAvatarURL({ size: 1024, dynamic: true }) // –ò–∫–æ–Ω–∫–∞ –±–æ—Ç–∞
        })
        .setDescription(`–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç: ${queue.currentTrack.title}\n\n${tracks.slice(0, 5).join('\n')}\n\n${nextSongs}`) // –û–ø–∏—Å–∞–Ω–∏–µ —Å —Ç–µ–∫—É—â–∏–º —Ç—Ä–µ–∫–æ–º –∏ —Ç—Ä–µ–∫–∞–º–∏ –≤ –æ—á–µ—Ä–µ–¥–∏
        .setTimestamp() // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–º–µ—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏
        .setFooter({ 
            text: await Translate('–ú—É–∑—ã–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ - –°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º <‚ù§Ô∏è>'), // –ü–æ–¥–ø–∏—Å—å –≤–Ω–∏–∑—É —Å–æ–æ–±—â–µ–Ω–∏—è
            iconURL: inter.member.avatarURL({ dynamic: true }) // –ò–∫–æ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—ã–∑–≤–∞–≤—à–µ–≥–æ –∫–æ–º–∞–Ω–¥—É
        });

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º embed-—Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
    inter.editReply({ embeds: [embed] });
}
